import{d as b,c as h,a as i,b as e,t as c,o as n,F as g,f as v,A as k,w as _,i as u,y as o,R as f,z as y,k as $,g as x,e as w,h as I}from"./index-DmIcfvM4.js";import{u as D,M as L,a as U,b as S}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-DgRYiN8i.js";const C={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-800"},T={class:"flex items-center gap-5"},N=["src","alt"],z={class:"text-xl font-bold text-slate-800 dark:text-white"},R={class:"text-slate-500 dark:text-slate-400"},j={class:"mt-6 grid grid-cols-2 gap-4"},B={class:"rounded-xl bg-violet-50 p-4 text-center dark:bg-violet-900/30"},M={class:"text-3xl font-bold text-violet-600 dark:text-violet-400"},V={class:"rounded-xl bg-emerald-50 p-4 text-center dark:bg-emerald-900/30"},A={class:"text-3xl font-bold text-emerald-600 dark:text-emerald-400"},F=b({__name:"UserProfile",props:{user:{},totalDays:{}},setup(r){const l=r,s=h(()=>`https://cdn.discordapp.com/embed/avatars/${parseInt(l.user.discordUserId)%5}.png`),a=h(()=>l.totalDays?Math.round(l.user.totalCheckinDays/l.totalDays*100):0);return(t,d)=>(n(),i("div",C,[e("div",T,[e("img",{src:r.user.avatarUrl||s.value,alt:r.user.displayName,class:"h-20 w-20 rounded-2xl object-cover ring-2 ring-slate-100 dark:ring-slate-700"},null,8,N),e("div",null,[e("h2",z,c(r.user.displayName),1),e("p",R,"@"+c(r.user.username),1)])]),e("div",j,[e("div",B,[e("p",M,c(r.user.totalCheckinDays),1),d[0]||(d[0]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"打卡天數",-1))]),e("div",V,[e("p",A,c(a.value)+"%",1),d[1]||(d[1]=e("p",{class:"text-sm text-slate-500 dark:text-slate-400"},"完成率",-1))])])]))}}),W={class:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm dark:border-slate-700 dark:bg-slate-800"},E={class:"space-y-3"},P={class:"flex items-center gap-3"},q={class:"min-w-0 flex-1"},G={class:"flex items-center gap-1"},H={class:"ml-2 flex-shrink-0 text-right"},J={key:0,class:"text-sm text-slate-600 dark:text-slate-300"},K={key:1,class:"text-sm text-slate-400 dark:text-slate-500"},O=b({__name:"CheckinStatusList",props:{details:{},scheduleId:{}},setup(r){function l(s,a){const d=new Date(s).toLocaleDateString("zh-TW",{month:"numeric",day:"numeric"});if(!a)return d;const m=new Date(a).toLocaleTimeString("zh-TW",{hour:"2-digit",minute:"2-digit"});return`${d} ${m}`}return(s,a)=>(n(),i("div",W,[a[0]||(a[0]=e("h3",{class:"mb-4 text-lg font-semibold text-slate-800 dark:text-white"},"打卡記錄",-1)),e("div",E,[(n(!0),i(g,null,v(r.details,t=>(n(),k(o(f),{key:t.dayLabel,to:{name:"day-detail",params:{scheduleId:r.scheduleId,dayLabel:t.dayLabel}},class:u(["flex items-center justify-between rounded-xl p-3 transition-colors",t.checkedIn?"bg-slate-50 hover:bg-slate-100 dark:bg-slate-700/50 dark:hover:bg-slate-700":"bg-slate-50/50 hover:bg-slate-100 dark:bg-slate-800 dark:hover:bg-slate-700/50"])},{default:_(()=>[e("div",P,[e("div",{class:u(["flex h-8 w-8 items-center justify-center rounded-lg",t.checkedIn?"bg-slate-200 dark:bg-slate-600":"bg-slate-100 dark:bg-slate-700"])},[e("i",{class:u(["bi bi-calendar-event text-sm",t.checkedIn?"text-slate-700 dark:text-slate-300":"text-slate-400 dark:text-slate-500"])},null,2)],2),e("div",q,[e("div",G,[e("span",{class:u(["text-sm font-medium",t.checkedIn?"text-slate-700 dark:text-slate-200":"text-slate-500 dark:text-slate-400"])},c(t.dayLabel)+"： ",3),e("span",{class:u(["text-sm truncate",t.checkedIn?"text-slate-500 dark:text-slate-400":"text-slate-400 dark:text-slate-500"])},c(t.threadTitle),3)])])]),e("div",H,[t.checkedIn?(n(),i("span",J,c(l(t.date,t.checkinTime)),1)):(n(),i("span",K,c(l(t.date,null)),1))])]),_:2},1032,["to","class"]))),128))])]))}}),Q={class:"p-8"},X={key:0,class:"flex h-96 items-center justify-center"},Y={class:"mb-8"},te=b({__name:"UserDetail",setup(r){const l=y(),s=D(),a=h(()=>l.params.scheduleId),t=h(()=>l.params.discordUserId);async function d(){await s.fetchUserDetail(a.value,t.value)}return $(()=>{d(),s.scheduleStats||s.fetchScheduleStats(a.value)}),(p,m)=>(n(),k(L,null,{default:_(()=>[e("div",Q,[x(o(f),{to:{name:"progress",params:{scheduleId:a.value}},class:"mb-6 inline-flex items-center gap-2 text-sm text-slate-500 transition-colors hover:text-slate-800 dark:hover:text-slate-200"},{default:_(()=>[...m[0]||(m[0]=[e("i",{class:"bi bi-arrow-left"},null,-1),I(" 返回進度追蹤 ",-1)])]),_:1},8,["to"]),o(s).isLoading&&!o(s).currentUser?(n(),i("div",X,[x(U,{size:"lg"})])):o(s).error?(n(),k(S,{key:1,message:o(s).error,onRetry:d},null,8,["message"])):o(s).currentUser?(n(),i(g,{key:2},[e("div",Y,[x(F,{user:o(s).currentUser,"total-days":o(s).scheduleStats?.dailyTasks},null,8,["user","total-days"])]),x(O,{details:o(s).currentUser.checkinDetails,"schedule-id":a.value},null,8,["details","schedule-id"])],64)):w("",!0)])]),_:1}))}});export{te as default};
