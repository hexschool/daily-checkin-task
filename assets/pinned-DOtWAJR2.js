import{B as O,r as f,w as x}from"./index-BqNsMgAy.js";import{c as A}from"./ErrorMessage.vue_vue_type_script_setup_true_lang-Bzh_Qjwu.js";const P="pinned-users",S=5,M=O("pinned",()=>{const t=f(h()),o=f(new Map),u=f(!1);function h(){try{const e=localStorage.getItem(P);return e?JSON.parse(e):{}}catch{return{}}}function k(){localStorage.setItem(P,JSON.stringify(t.value))}x(t,k,{deep:!0});function s(e){return t.value[e]||[]}function c(e,n){return s(e).includes(n)}function p(e){return s(e).length}function v(e){return p(e)<S}function g(e,n){return v(e)?(c(e,n)||(t.value[e]||(t.value[e]=[]),t.value[e].push(n)),!0):!1}function l(e,n){const a=t.value[e];if(!a)return;const i=a.indexOf(n);i!==-1&&(a.splice(i,1),o.value.delete(n))}function D(e,n){return c(e,n)?(l(e,n),!1):g(e,n)}function N(e){return s(e).map(a=>o.value.get(a)).filter(a=>a!==void 0)}async function w(e){const n=s(e);if(n.length!==0){u.value=!0;try{const a=n.map(async i=>{try{const r=await A.getUserDetail(e,i),m={};r.checkinDetails.forEach(y=>{m[y.dayLabel]=y.checkedIn});const E={discordUserId:r.discordUserId,username:r.username,displayName:r.displayName,avatarUrl:r.avatarUrl,totalCheckinDays:r.totalCheckinDays,checkinStatus:m};o.value.set(i,E)}catch(r){console.error(`Failed to fetch pinned user ${i}:`,r),l(e,i)}});await Promise.all(a)}finally{u.value=!1}}}function d(e){delete t.value[e],o.value.clear()}return{pinnedMap:t,pinnedUserDetails:o,isLoadingPinned:u,getPinnedIds:s,isPinned:c,getPinnedCount:p,canPin:v,getPinnedUserList:N,pinUser:g,unpinUser:l,togglePin:D,fetchPinnedUsers:w,clearPinned:d,MAX_PINNED:S}});export{M as u};
